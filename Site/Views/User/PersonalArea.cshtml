@using Site.Data.Models.User;
@using Site.Data.Models.UserIdentity
@model IIdentified<Self>

@{
    Layout = "_HomeLayout";
}

<h2>Личный кабинет</h2>
<div class="navbar-collapse collapse d-sm-inline-flex justify-content-between">
    <ul class="navbar-nav flex-grow-1">
        <li class="nav-item">
            <button style="height:50px;width:200px">
                <a class="nav-link text-dark"
                   asp-controller="Home"
                   asp-action="Index"
                   asp-route-callerController="Home"
                   asp-route-callerAction="Index"
                   asp-route-id="@Model?.Value.Id"
                   asp-route-login="@Model?.Login"
                   asp-route-type="@Model?.Type"
                   asp-route-userId="@Model?.UserId"
                   asp-route-password="@Model?.Password">Вернуться на главную</a>
                </button>
        </li>
    </ul>
</div>
<hr/>
<h2>Личные данные</h2>
@await Html.PartialAsync("UserInfo",Model)
<hr/>
<h2>Друзья</h2>
@{
    foreach (var friend in Model.Value.Friends)
    {
        @await Html.PartialAsync("UserInfo", new Identified<Friend>(Model, friend))
        <p>
            <button style="height:50px;width:146px">
                <a class="nav-link text-dark"
                   asp-controller="Chat"
                   asp-action="Chat"
                   asp-route-id="@friend.ChatId"
                   asp-route-login="@Model?.Login"
                   asp-route-type="@Model?.Type"
                   asp-route-userId="@Model?.UserId"
                   asp-route-password="@Model?.Password">Чат</a></button></p>
        <hr/>
    }
}
<hr/>
<h2>Управление</h2>
<p><b>Изменить ник: </b></p>
<form asp-controller="User"
      asp-action="UpdateNick">
    <input type="hidden" name="login" value="@Model.Login"/>
    <input type="hidden" name="password" value="@Model.Password"/>
    <input type="text" name="nick" value="@Model.Value.Nick"/>
    <input type="hidden" name="type" value="@Model.Type"/>
    <input type="submit" value="Подтвердить"/>
</form>
<p><b>Изменить логин: </b></p>
<form asp-controller="User"
      asp-action="UpdateLogin">
    <input type="hidden" name="login" value="@Model.Login"/>
    <input type="hidden" name="password" value="@Model.Password"/>
    <input type="hidden" name="type" value="@Model.Type"/>
    <input type="text" name="newLogin"/>
    <input type="submit" value="Подтвердить"/>
</form>
<p><b>Изменить пароль: </b></p>
<form asp-controller="User"
      asp-action="UpdatePassword">
    <input type="hidden" name="login" value="@Model.Login"/>
    <input type="hidden" name="password" value="@Model.Password"/>
    <input type="hidden" name="type" value="@Model.Type"/>
    <input type="text" name="newPassword"/>
    <input type="submit" value="Подтвердить"/>
</form>
<p><b>Изменить email: </b></p>
<form asp-controller="User"
      asp-action="UpdateEmail">
    <input type="hidden" name="login" value="@Model.Login"/>
    <input type="hidden" name="password" value="@Model.Password"/>
    <input type="hidden" name="type" value="@Model.Type"/>
    <input type="text" name="email"/>
    <input type="submit" value="Подтвердить"/>
</form>
<p><b>Выбрать картинку: </b></p>
<form asp-controller="User"
      asp-action="UpdatePicture">
    <input type="hidden" name="login" value="@Model.Login"/>
    <input type="hidden" name="password" value="@Model.Password"/>
    <input type="hidden" name="type" value="@Model.Type"/>
    @{
        foreach (var p in Model.Value.Pictures)
        {
            <label for="@p.Id"><img src="@p.Url" width="100" height="100"></label>
            <input type="radio" name="picture" id="@p.Id" value="@p.Id"/>
        }
    }
    <input type="submit" value="Подтвердить"/>
</form>